<nav role="navigation" aria-label="Menu principal" id="navbar" class="bg-stone-100 dark:bg-gray-900 shadow-lg fixed -top-16 left-0 w-full transition-all duration-300 z-50">
  <div class="md:mx-8 px-4">
    <div class="flex space-x-7 justify-between">
      <div class="mr-8">
        <a href="/" class="flex items-center py-4 px-2">
          <img
            src="../assets/images/logo_annmof-cropped.webp"
            alt="Logo"
            class="h-8 w-8 mr-2"
            width=32px
            height=32px
          />
          <div class="hidden dark:block dark:absolute top-2 left-4 -z-10 h-12 w-12 bg-stone-100 rounded-full"></div>
          <span class="font-semibold text-gray-900 dark:text-stone-100 ml-2 text-lg bimbo">Annmof</span>
        </a>
      </div>
      <ul class="hidden lg:flex items-center">
        {% for item in services %}
          <li>
            <a href="{{ item.link }}" class="nav-link" {% if item.link in page.url %} aria-current="page"{% endif %}>
              {{ item.title }}
            </a>
          </li>
        {% endfor %}
      </ul>
      <div class="flex flex-row gap-8">
        <div class="flex items-center md:pl-8">
          <label for="darkModeToggle" class="flex items-center cursor-pointer">
            <div class="relative">
              <input type="checkbox" id="darkModeToggle" checked class="sr-only" onclick="enableDarkMode()">
              <div class="switch block bg-stone-200 dark:bg-gray-700 w-10 h-6 rounded-full"></div>
              <div class="dot dark:translate-x-full absolute left-1 top-1 bg-white dark:bg-green-300 w-4 h-4 rounded-full transition"></div>
            </div>
            <div class="ml-3 text-gray-900 dark:text-stone-100 text-xs text-center">
              mode sombre
            </div>
          </label>
        </div>
        <div class="lg:hidden flex items-center">
          <button aria-expanded="false" class="outline-none mobile-menu-button text-sm text-gray-900 dark:text-stone-100 text-center">
            <div class="mb-1 flex flex-col items-center">
              <span id="hamb-top" class="transition duration-300 mb-1 w-6 block h-1 bg-gray-900 dark:bg-stone-100 rounded"></span>
              <span id="hamb-mid" class="transition duration-300 mb-1 w-6 block h-1 bg-gray-900 dark:bg-stone-100 rounded"></span>
              <span id="hamb-bot" class="transition duration-300 w-6 block h-1 bg-gray-900 dark:bg-stone-100 rounded"></span>
            </div>
            menu
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="hidden mobile-menu">
    <ul>
      {% for item in services %}
        <li>
          <a href="{{ item.link }}" class="menu-item" {% if item.link in page.url %} aria-current="page"{% endif %}>
            {{ item.title }}
          </a>
        </li>
      {% endfor %}
    </ul>
  </div>
  <script>
    function enableDarkMode(){
      if(localStorage.theme === "dark"){
        localStorage.theme = "light";
        document.body.classList.remove("dark");
      }
      else {
        localStorage.theme = "dark";
        document.body.classList.add("dark");
      }
    }
    const btn = document.querySelector("button.mobile-menu-button");
    const menu = document.querySelector(".mobile-menu");
    const hamburgerTop = document.getElementById("hamb-top");
    const hamburgerMid = document.getElementById("hamb-mid");
    const hamburgerBot = document.getElementById("hamb-bot");

    btn.addEventListener("click", () => {
      let x = btn.getAttribute("aria-expanded");
      menu.classList.toggle("hidden");
      if(x == "false"){
        x = "true";
      }
      else{
        x = "false";
      }
      btn.setAttribute("aria-expanded",x);
      hamburgerTop.classList.toggle("open-top");
      hamburgerMid.classList.toggle("open-mid");
      hamburgerBot.classList.toggle("open-bot");
    });
    {% if page.url == "/"%}
      window.onscroll = function() {
        let currentScrollPos = window.pageYOffset;
        if(currentScrollPos >= 600){
          document.getElementById("navbar").style.top = "0";
        }
        else{
          document.getElementById("navbar").style.top = "-4rem";
          menu.classList.add("hidden");
          hamburgerTop.classList.remove("open-top");
          hamburgerMid.classList.remove("open-mid");
          hamburgerBot.classList.remove("open-bot");
        }
      }
    {% else %}
      document.getElementById("navbar").style.top = "0";
    {% endif %}
  </script>
</nav>